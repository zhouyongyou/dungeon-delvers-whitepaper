# 4. NFT 系統詳解 (NFT System)

> **基於智能合約的實際 NFT 機制** - 與合約實現完全一致

## 4.1 統一稀有度系統

### 💎 五星稀有度機率表
所有 NFT (英雄和神器) 都使用統一的稀有度系統：

| 稀有度 | 星級 | 抽中機率 | 英雄戰力範圍 | 神器容量 |
|--------|------|----------|-------------|----------|
| **N** (Normal) | ⭐ | 44% | 15-50 | 1 |
| **R** (Rare) | ⭐⭐ | 35% | 50-100 | 2 |
| **SR** (Super Rare) | ⭐⭐⭐ | 15% | 100-150 | 3 |
| **SSR** (Super Super Rare) | ⭐⭐⭐⭐ | 5% | 150-200 | 4 |
| **UR** (Ultra Rare) | ⭐⭐⭐⭐⭐ | 1% | 200-255 | 5 |

### 🎲 公平隨機機制
- **Chainlink VRF V2.5** 提供可驗證的隨機數
- **10-30 秒等待時間** 確保隨機品質
- **額外成本約 $0.6-1.0** 保證絕對公平
- **每次鑄造獨立** 不分批次，統一機率

## 4.2 英雄 NFT 系統

### ⚔️ 英雄屬性詳解
**合約地址**: `0x6d4393ad1507012039a6f1364f70b8de3afcb3bd`

**核心屬性**:
- **戰力 (Power)**: 決定探險成功率的核心數值
- **稀有度 (Rarity)**: 影響戰力範圍和視覺外觀
- **等級 (Level)**: 通過探險獲得經驗值提升
- **經驗值 (Experience)**: 每次成功探險獲得

**戰力分佈**:
```
⭐ N級英雄:  15-50 戰力   (44% 機率)
⭐⭐ R級英雄:  50-100 戰力  (35% 機率)
⭐⭐⭐ SR級英雄: 100-150 戰力 (15% 機率)  
⭐⭐⭐⭐ SSR級英雄: 150-200 戰力 (5% 機率)
⭐⭐⭐⭐⭐ UR級英雄: 200-255 戰力 (1% 機率)
```

### 🦸‍♂️ 英雄成長系統
- **基礎戰力**: 鑄造時隨機決定
- **等級加成**: 每升1級增加少量戰力
- **經驗獲得**: 每次成功探險獲得經驗
- **升階進化**: 通過升階祭壇提升星級

## 4.3 神器 NFT 系統

### ⚔️ 神器屬性詳解  
**合約地址**: `0x3bcb4af9d94b343b1f154a253a6047b707ba74bd`

**核心功能**:
- **容量 (Capacity)**: 決定可組建隊伍的英雄數量
- **稀有度加成**: 高級神器提供額外戰力加成
- **組隊限制**: 每個神器只能容納對應數量的英雄

**容量系統**:
```
⭐ N級神器: 容量 1 (可放1個英雄)     (44% 機率)
⭐⭐ R級神器: 容量 2 (可放2個英雄)     (35% 機率)  
⭐⭐⭐ SR級神器: 容量 3 (可放3個英雄)   (15% 機率)
⭐⭐⭐⭐ SSR級神器: 容量 4 (可放4個英雄) (5% 機率)
⭐⭐⭐⭐⭐ UR級神器: 容量 5 (可放5個英雄) (1% 機率)
```

### 🛡️ 神器戰略價值
- **隊伍規模**: 更高容量允許組建更強大的隊伍
- **戰力倍增**: 多英雄組合的總戰力更高
- **探險效率**: 大隊伍可挑戰高難度地下城
- **收益最大化**: 高難度地下城提供更多 $SOUL 獎勵

## 4.4 隊伍系統 (Party System)

### 👥 組隊機制
**合約地址**: `0x0d93b2c10d5ff944b3bb47c75b52fca75c92a4cc`

**組隊規則**:
1. **選擇神器**: 首先選擇一個神器作為隊伍基礎
2. **放入英雄**: 根據神器容量放入對應數量的英雄
3. **計算戰力**: 隊伍總戰力 = 所有英雄戰力之和
4. **探險準備**: 組建完成的隊伍可以進行地下城探險

**隊伍戰力計算**:
```
隊伍總戰力 = 英雄1戰力 + 英雄2戰力 + ... + 英雄N戰力

範例：
- 1個 UR英雄(250戰力) + UR神器(容量5) = 可再加4個英雄
- 如果加入 4個SR英雄(平均125戰力) = 總戰力 750
- 可挑戰最高難度的虛空裂隙($450 獎勵)
```

## 4.5 升階祭壇系統 (Altar of Ascension)

### ✨ 升階機制
**合約地址**: `0xda7fb30cb2a2311ca3326ad2a4f826dcdac8bd7b`

**升階規則**:
| 升級目標 | 需要材料 | 升級費用 (BNB) | 大成功 | 普通成功 | 部分返還 | 完全失敗 |
|----------|----------|----------------|---------|----------|----------|----------|
| **1★→2★** | 5個 1★ NFT | 0.005 | 8% (得2個) | 77% (得1個) | 13% (返還2個) | 2% (全失) |
| **2★→3★** | 4個 2★ NFT | 0.01 | 6% (得2個) | 69% (得1個) | 20% (返還2個) | 5% (全失) |
| **3★→4★** | 3個 3★ NFT | 0.02 | 5% (得2個) | 48% (得1個) | 37% (返還1個) | 10% (全失) |
| **4★→5★** | 2個 4★ NFT | 0.05 | 6% (得2個) | 34% (得1個) | 46% (返還1個) | 14% (全失) |

### 🎯 升階策略分析
**經濟效益**:
- **低星升級**: 成功率高，適合批量處理
- **高星升級**: 風險高但收益巨大
- **材料管理**: 失敗返還機制降低損失
- **長期投資**: UR級 NFT 價值極高

### 💡 升階最佳實踐
1. **積累低星材料**: 大量鑄造1-2★ NFT作為升階材料
2. **分批升階**: 不要一次性升階，分散風險
3. **計算期望值**: 考慮成功率和材料成本
4. **保留精品**: 戰力優秀的NFT不要輕易當材料

## 4.6 VIP 卡系統 (VIP Card - SBT)

### 🌟 VIP 會員卡屬性
**合約地址**: `0x0440634aa6e4028efafefe7683b39e3a7bec0ebc`

**VIP 卡特性**:
- **靈魂綁定 (Soulbound)**: 不可轉移的特殊 NFT
- **質押功能**: 需要質押 $SOUL 代幣激活
- **等級系統**: 根據質押數量決定 VIP 等級
- **專屬權益**: 享受稅率減免和額外獎勵

**VIP 等級權益**:
```
VIP 0 (普通): 基礎稅率 15%
VIP 1: 稅率減免至 12%  
VIP 2: 稅率減免至 10%
VIP 3+: 稅率減免至 8%
```

### 💎 VIP 質押機制
- **最低質押**: 需要質押一定數量的 $SOUL
- **動態調整**: 可隨時增加或減少質押
- **即時生效**: 質押變更立即影響 VIP 等級
- **收益加成**: 高等級 VIP 獲得更多探險獎勵

## 4.7 玩家檔案系統 (Player Profile - SBT)

### 📊 玩家檔案屬性
**合約地址**: `0xa7aab98223268f8049430bdba6d1ba36cbef424a`

**核心功能**:
- **自動創建**: 首次探險成功時自動鑄造
- **經驗追蹤**: 記錄累積經驗值和探險次數
- **等級計算**: 等級 = √(總經驗值/100) + 1  
- **稅率加成**: 等級越高提領稅率越低

**等級系統**:
```
等級 1: 0-99 經驗值
等級 2: 100-399 經驗值  
等級 3: 400-899 經驗值
等級 4: 900-1599 經驗值
等級 5: 1600+ 經驗值
```

**稅率減免**:
- 每個玩家等級提供 **0-5%** 的稅率減免
- 與 VIP 等級減免疊加計算
- 激勵長期遊戲參與

## 4.8 NFT 元數據系統

### 🎨 動態 NFT 藝術
- **實時生成**: 所有 NFT 圖像由智能合約實時生成
- **屬性反映**: 視覺效果反映 NFT 的實際屬性
- **稀有度區別**: 不同星級有不同的視覺風格
- **升級變化**: 升階後外觀會相應改變

### 📡 元數據 API
**後端服務**: `dungeon-delvers-metadata-server`
- **動態元數據**: 實時反映 NFT 當前狀態
- **標準兼容**: 完全符合 ERC-721 元數據標準
- **快速響應**: 5分鐘緩存確保數據新鮮度
- **高可用性**: 多層緩存和 CDN 加速

---

> **💡 NFT 設計哲學**：DungeonDelvers 的 NFT 不僅僅是收藏品，更是功能性的遊戲資產。每個 NFT 都有明確的遊戲用途，通過遊戲機制驅動真實的需求和價值。

**智能合約**: 所有 NFT 邏輯都通過智能合約實現，確保屬性和稀有度的絕對公平。  
**動態成長**: NFT 屬性會隨著遊戲進度動態變化，提供持續的成長樂趣。